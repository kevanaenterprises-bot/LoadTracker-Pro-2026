<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LoadTracker Pro - Driver Portal</title>
  <script>
    // Driver Portal SPA Fallback
    // This file is served when the hosting platform serves static files
    // for /driver-portal instead of the SPA's index.html.
    // It redirects to the root with a _dp parameter so the SPA can handle routing.
    (function() {
      try {
        var search = window.location.search;
        var params = new URLSearchParams(search);
        var token = params.get('token');
        var driverUrl = '/driver-portal';
        if (token) {
          driverUrl += '?token=' + encodeURIComponent(token);
        } else if (search) {
          driverUrl += search;
        }
        var redirectUrl = '/?_dp=' + encodeURIComponent(driverUrl);
        
        // Update the meta refresh tag as fallback
        var meta = document.getElementById('meta-refresh');
        if (meta) meta.setAttribute('content', '2;url=' + redirectUrl);
        
        // Primary redirect
        window.location.replace(redirectUrl);
      } catch (e) {
        // If JS redirect fails, the meta refresh (below) will handle it after 2 seconds
        // Or the user can click the manual link
        console.error('Redirect error:', e);
        try {
          document.getElementById('manual-link').style.display = 'block';
          document.getElementById('manual-link').href = '/driver-portal' + window.location.search;
        } catch(e2) { /* ignore */ }
      }
    })();
  </script>
  <!-- Meta refresh as fallback if JavaScript fails -->
  <meta id="meta-refresh" http-equiv="refresh" content="3;url=/?_dp=%2Fdriver-portal">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
      color: #475569;
    }
    .loader { text-align: center; }
    .spinner {
      width: 40px; height: 40px;
      border: 4px solid #e2e8f0;
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    #manual-link {
      display: none;
      margin-top: 16px;
      color: #3b82f6;
      text-decoration: underline;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="loader">
    <div class="spinner"></div>
    <p>Loading Driver Portal...</p>
    <a id="manual-link" href="/driver-portal">Click here if not redirected</a>
    <noscript>
      <p style="margin-top:16px;font-size:14px">
        <a href="/driver-portal" style="color:#3b82f6">Click here to open the Driver Portal</a>
      </p>
    </noscript>
  </div>
</body>
</html>
